#include<Date.au3>
#include <IE.au3>
Local $oIE = _IECreate("http://139.127.40.17/reportconsole/ReportController")
WinSetState("Vocera Report Console Login","",@SW_MAXIMIZE)
$d = @MON - 1
$begindate = 1
If $d = 1 Or $d = 3 Or $d = 5 Or $d = 7 Or $d = 8 Or $d = 10 Or $d = 12 Then
   $enddate = 31
EndIf
If $d = 4 Or $d = 6 Or $d = 9 Or $d = 11 Then
   $enddate = 30
EndIf
If $d = 2 Then
   $enddate = 28
EndIf
$monthlyreportdate = $d & "/" & $begindate & "/" & @YEAR
$monthlyreportdate2 = $d & "/" & $enddate & "/" & @YEAR
If @MDAY < 15 Then
   $enddate = 15
EndIf
If @MDAY > 15 Then
   $begindate = 16
EndIf
$bimonthlyreportdate = $d & "/" & $begindate & "/" & @YEAR
$bimonthlyreportdate2 = $d & "/" & $enddate & "/" & @YEAR
If @MDAY < 10 Then
   $enddate = 10
EndIf
If @MDAY < 20 And @MDAY > 10 Then
   $begindate = 11
   $enddate = 20
EndIf
If @MDAY > 20 Then
   $begindate = 21
EndIf
$trimonthlyreportdate = $d & "/" & $begindate & "/" & @YEAR
$trimonthlyreportdate2 = $d & "/" & $enddate & "/" & @YEAR
Sleep(4000)
Local $oSubmit = _IEGetObjByName($oIE, "password")
_IEAction($oSubmit, "click")
Send("HRVOC03")
Sleep(1000)
Send("{ENTER}")
Sleep(10000)

Local $oSubmit1 = _IEGetObjByName($oIE, "device_management_link")
_IEAction($oSubmit1, "click")
Sleep(3000)
Local $i = 0
While $i < 26
   Send("{TAB}")
   $i = $i + 1
WEnd
$i = 0
While $i < 3
   Send("{DOWN}")
   $i = $i + 1
WEnd
Local $oSubmit2 = _IEGetObjByName($oIE, "save")
_IEAction($oSubmit2, "click")
Sleep(2000)
Send("{TAB}")
Sleep(2000)
Send("{TAB}")
Sleep(2000)
Send($monthlyreportdate)
Sleep(2000)
Send("{TAB}")
Sleep(2000)
Send("{TAB}")
Sleep(2000)
Send("{TAB}")
Sleep(2000)
Send($monthlyreportdate2)
Sleep(2000)
Send("{TAB}")
Sleep(2000)
Send("{TAB}")
Sleep(2000)
Send("{TAB}")
Sleep(2000)
Send("{DOWN}")
Sleep(2000)
Send("{DOWN}")
Sleep(2000)
Send("{TAB}")
Sleep(2000)
Send("{TAB}")
Sleep(1000)
Send("{DOWN}")
Sleep(1000)
Send("{DOWN}")
Sleep(1000)
Send("{TAB}")
Sleep(1000)
Send("{TAB}")
Sleep(1000)
Send("{ENTER}")
Sleep(1000)
Send("{TAB}")
Sleep(1000)
Send("{TAB}")
Sleep(2000)
Send("{TAB}")
Sleep(2000)
Send("{TAB}")
Sleep(2000)
Send("{DOWN}")
Sleep(2000)
Send("{TAB}")
Sleep(2000)
Send("{ENTER}")
Sleep(2000)
Send("{DOWN}")
Sleep(2000)
Send("{DOWN}")
Sleep(2000)
Send("{DOWN}")
Sleep(2000)
Send("{TAB}")
Sleep(2000)
Send("{ENTER}")
Sleep(2000)
Send("{TAB}")
Sleep(2000)
Send("{TAB}")
Sleep(2000)
Send("{TAB}")
Sleep(2000)
Send("{TAB}")
Sleep(2000)
Send("{ENTER}")
Sleep(600000)
Send("{TAB}")
Sleep(1000)
Send("{TAB}")
Sleep(1000)
Send("{TAB}")
Sleep(1000)
Send("{TAB}")
Sleep(1000)
Send("{ENTER}")
Sleep(1000)
Send("{TAB}")
Sleep(1000)
Send("{TAB}")
Sleep(1000)
Send("{TAB}")
Sleep(1000)
Send("{ENTER}")
Sleep(1000)
Send("{DOWN}")
Sleep(1000)
Send("{DOWN}")
Sleep(1000)
Send("{DOWN}")
Sleep(1000)
Send("{DOWN}")
Sleep(1000)
Send("{DOWN}")
Sleep(1000)
Send("{DOWN}")
Sleep(1000)
Send("{ENTER}")
Sleep(1000)
Send("{TAB}")
Sleep(1000)
Send("{TAB}")
Sleep(1000)
Send("{TAB}")
Sleep(1000)
Send("{ENTER}")
Sleep(600000)
Send("{LEFT}")
Sleep(1000)
Send("{ENTER}")
Sleep(1000)
;Send("{ENTER}")
;Sleep(3000)
Send("Device Inventory - Detail (Device Management)")
Send("{ENTER}")
Sleep(20000)
Send("{ENTER}")
WinClose ("Crystal Reports Viewer")
$i = 0
While $i < 28
   Send("{TAB}")
   $i = $i + 1
WEnd
Send("{DOWN}")
$oSubmit2 = _IEGetObjByName($oIE, "save")
_IEAction($oSubmit2, "click")
Sleep(2000)
Send("{TAB}")
Sleep(2000)
Send("{TAB}")
Sleep(2000)
Send($monthlyreportdate)
Sleep(2000)
Send("{TAB}")
Sleep(2000)
Send("{TAB}")
Sleep(2000)
Send("{TAB}")
Sleep(2000)
Send($monthlyreportdate2)
Sleep(2000)
Send("{TAB}")
Sleep(2000)
Send("{TAB}")
Sleep(2000)
Send("{TAB}")
Sleep(2000)
Send("{DOWN}")
Sleep(2000)
Send("{DOWN}")
Sleep(2000)
Send("{TAB}")
Sleep(2000)
Send("{TAB}")
Sleep(1000)
Send("{DOWN}")
Sleep(1000)
Send("{DOWN}")
Sleep(1000)
Send("{TAB}")
Sleep(1000)
Send("{TAB}")
Sleep(1000)
Send("{ENTER}")
Sleep(1000)
Send("{TAB}")
Sleep(1000)
Send("{TAB}")
Sleep(2000)
Send("{TAB}")
Sleep(2000)
Send("{TAB}")
Sleep(2000)
Send("{DOWN}")
Sleep(2000)
Send("{TAB}")
Sleep(2000)
Send("{ENTER}")
Sleep(2000)
Send("{DOWN}")
Sleep(2000)
Send("{DOWN}")
Sleep(2000)
Send("{DOWN}")
Sleep(2000)
Send("{TAB}")
Sleep(2000)
Send("{ENTER}")
Sleep(2000)
Send("{TAB}")
Sleep(2000)
Send("{TAB}")
Sleep(2000)
Send("{TAB}")
Sleep(2000)
Send("{TAB}")
Sleep(2000)
Send("{ENTER}")
Sleep(900000)
Send("{TAB}")
Sleep(1000)
Send("{TAB}")
Sleep(1000)
Send("{TAB}")
Sleep(1000)
Send("{TAB}")
Sleep(1000)
Send("{ENTER}")
Sleep(1000)
Send("{TAB}")
Sleep(1000)
Send("{TAB}")
Sleep(1000)
Send("{TAB}")
Sleep(1000)
Send("{ENTER}")
Sleep(1000)
Send("{DOWN}")
Sleep(1000)
Send("{DOWN}")
Sleep(1000)
Send("{DOWN}")
Sleep(1000)
Send("{DOWN}")
Sleep(1000)
Send("{DOWN}")
Sleep(1000)
Send("{DOWN}")
Sleep(1000)
Send("{ENTER}")
Sleep(1000)
Send("{TAB}")
Sleep(1000)
Send("{TAB}")
Sleep(1000)
Send("{TAB}")
Sleep(1000)
Send("{ENTER}")
Sleep(900000)
Send("{LEFT}")
Sleep(1000)
Send("{ENTER}")
Sleep(1000)
;Send("{ENTER}")
;Sleep(3000)
Send("Device Usage (Device Management)")
Send("{ENTER}")
Sleep(20000)
Send("{ENTER}")
WinClose ("Crystal Reports Viewer")

$oSubmit1 = _IEGetObjByName($oIE, "export_data_link")
_IEAction($oSubmit1, "click")
Sleep(3000)
$i = 0
While $i < 26
   Send("{TAB}")
   $i = $i + 1
WEnd
$i = 0
While $i < 2
   Send("{DOWN}")
   $i = $i + 1
WEnd
$i = 0
$oSubmit2 = _IEGetObjByName($oIE, "save")
_IEAction($oSubmit2, "click")
Sleep(2000)
Send("{TAB}")
Sleep(2000)
Send("{TAB}")
Sleep(2000)
Send($bimonthlyreportdate)
Sleep(2000)
Send("{TAB}")
Sleep(2000)
Send("{TAB}")
Sleep(2000)
Send("{TAB}")
Sleep(2000)
Send($bimonthlyreportdate2)
Sleep(2000)
Send("{TAB}")
Sleep(2000)
Send("{TAB}")
Sleep(2000)
Send("{TAB}")
Sleep(2000)
Send("{DOWN}")
Sleep(2000)
Send("{DOWN}")
Sleep(2000)
Send("{TAB}")
Sleep(2000)
Send("{TAB}")
Sleep(2000)
Send("{ENTER}")
Sleep(2000)
Send("{TAB}")
Sleep(2000)
Send("{TAB}")
Sleep(2000)
Send("{TAB}")
Sleep(2000)
Send("{TAB}")
Sleep(2000)
Send("{TAB}")
Sleep(2000)
Send("{ENTER}")
Sleep(240000)
Send("{LEFT}")
Sleep(2000)
Send("{ENTER}")
Sleep(20000)
Send("{ENTER}")
Sleep(2000)

$oSubmit1 = _IEGetObjByName($oIE, "call_logs_link")
_IEAction($oSubmit1, "click")
Sleep(3000)
$oSubmit2 = _IEGetObjByName($oIE, "save")
_IEAction($oSubmit2, "click")
Sleep(2000)
Send("{TAB}")
Sleep(2000)
Send("{TAB}")
Sleep(2000)
Send($trimonthlyreportdate)
Sleep(2000)
Send("{TAB}")
Sleep(2000)
Send("{TAB}")
Sleep(2000)
Send("{TAB}")
Sleep(2000)
Send($trimonthlyreportdate2)
Send("{TAB}")
Sleep(2000)
Send("{TAB}")
Sleep(2000)
Send("{TAB}")
Sleep(2000)
Send("{DOWN}")
Sleep(2000)
Send("{DOWN}")
Sleep(2000)
Send("{TAB}")
Sleep(2000)
Send("{TAB}")
Sleep(2000)
Send("{TAB}")
Sleep(2000)
Send("{ENTER}")
Sleep(2000)
Send("{TAB}")
Sleep(2000)
Send("{TAB}")
Sleep(2000)
Send("{TAB}")
Sleep(2000)
Send("{TAB}")
Sleep(2000)
Send("{UP}")
Sleep(2000)
Send("{TAB}")
Sleep(2000)
Send("{ENTER}")
Sleep(2000)
Send("{TAB}")
Sleep(2000)
Send("{TAB}")
Sleep(2000)
Send("{TAB}")
Sleep(2000)
Send("{TAB}")
Sleep(2000)
Send("{ENTER}")
Sleep(240000)
Send("{TAB}")
Sleep(1000)
Send("{TAB}")
Sleep(1000)
Send("{TAB}")
Sleep(1000)
Send("{TAB}")
Sleep(1000)
Send("{ENTER}")
Sleep(1000)
Send("{TAB}")
Sleep(1000)
Send("{TAB}")
Sleep(1000)
Send("{TAB}")
Sleep(1000)
Send("{ENTER}")
Sleep(1000)
Send("{DOWN}")
Sleep(1000)
Send("{DOWN}")
Sleep(1000)
Send("{DOWN}")
Sleep(1000)
Send("{DOWN}")
Sleep(1000)
Send("{DOWN}")
Sleep(1000)
Send("{DOWN}")
Sleep(1000)
Send("{ENTER}")
Sleep(1000)
Send("{TAB}")
Sleep(1000)
Send("{TAB}")
Sleep(1000)
Send("{TAB}")
Sleep(1000)
Send("{ENTER}")
Sleep(240000)
Send("{LEFT}")
Sleep(1000)
Send("{ENTER}")
Sleep(1000)
;Send("{ENTER}")
;Sleep(3000)
Send("Push to Talk")
Send("{ENTER}")
Sleep(20000)
Send("{ENTER}")
WinClose ("Crystal Reports Viewer")
